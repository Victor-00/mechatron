<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Snakes and Ladders Login</title>
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Fredoka:wght@400;700&display=swap');

    body {
      margin: 0;
      padding: 0;
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      overflow: hidden;
    }

    .font-fredoka {
      font-family: 'Fredoka', sans-serif;
    }

    .login-page {
      min-height: 100vh;
      background: linear-gradient(135deg, #f5d742 0%, #4ade80 100%);
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 20px;
      position: relative;
      overflow: hidden;
    }

    .board-background {
      position: absolute;
      inset: 0;
      opacity: 0.1;
      display: grid;
      grid-template-columns: repeat(8, 1fr);
      grid-template-rows: repeat(12, 1fr);
    }

    .board-cell {
      border: 4px solid rgba(255, 255, 255, 0.5);
    }

    .dice {
      position: fixed;
      width: 40px;
      height: 40px;
      background: white;
      border-radius: 8px;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
      z-index: 10;
      animation: float 3s infinite ease-in-out;
      opacity: 0;
      transition: opacity 0.5s ease;
    }

    .dice::before {
      content: '';
      position: absolute;
      top: 2px;
      left: 2px;
      right: 2px;
      bottom: 2px;
      border: 2px solid #ddd;
      border-radius: 6px;
    }

    .dice-dot {
      position: absolute;
      width: 6px;
      height: 6px;
      background: #333;
      border-radius: 50%;
    }

    .dot-center {
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
    }

    .dot-top-left {
      top: 25%;
      left: 25%;
    }

    .dot-top-right {
      top: 25%;
      right: 25%;
    }

    .dot-bottom-left {
      bottom: 25%;
      left: 25%;
    }

    .dot-middle-left {
      top: 50%;
      left: 25%;
      transform: translateY(-50%);
    }

    .dot-middle-right {
      top: 50%;
      right: 25%;
      transform: translateY(-50%);
    }

    .dot-bottom-right {
      bottom: 25%;
      right: 25%;
    }

    @keyframes float {

      0%,
      100% {
        transform: translateY(0) rotate(0deg);
      }

      50% {
        transform: translateY(-10px) rotate(5deg);
      }
    }

    .login-form {
      background: rgba(255, 255, 255, 0.8);
      backdrop-filter: blur(8px);
      padding: 30px;
      border-radius: 24px;
      box-shadow: 0 10px 25px rgba(0, 0, 0, 0.2);
      width: 100%;
      max-width: 360px;
      z-index: 20;
      position: relative;
      opacity: 0;
      transform: scale(0.8);
      transition: opacity 0.5s ease, transform 0.5s ease;
    }

    .form-visible {
      opacity: 1;
      transform: scale(1);
    }

    .form-title {
      font-size: 28px;
      margin-bottom: 24px;
      text-align: center;
      color: #333;
    }

    .form-input {
      width: 100%;
      padding: 12px;
      margin-bottom: 16px;
      border-radius: 12px;
      border: 1px solid #ccc;
      font-size: 16px;
      box-sizing: border-box;
    }

    .form-input:focus {
      outline: none;
      border-color: #9333ea;
      box-shadow: 0 0 0 2px rgba(147, 51, 234, 0.2);
    }

    .submit-button {
      width: 100%;
      padding: 16px;
      border-radius: 12px;
      border: none;
      background: linear-gradient(135deg, #9333ea 0%, #ec4899 100%);
      color: white;
      font-size: 18px;
      font-weight: bold;
      cursor: pointer;
      box-shadow: 0 4px 12px rgba(147, 51, 234, 0.3);
      transition: all 0.2s ease;
    }

    .submit-button:hover {
      transform: scale(1.05);
    }

    .submit-button:active {
      transform: scale(0.95);
    }

    /* Snake Animation */
    .snake-container {
      position: fixed;
      width: 100%;
      height: 100%;
      z-index: 30;
      pointer-events: none;
    }

    .snake {
      position: absolute;
      top: 50%;
      left: -200px;
      transform: translateY(-50%);
      width: 200px;
      height: 100px;
      filter: drop-shadow(0 0 10px rgba(0, 0, 0, 0.5));
      animation: snake-move 3s ease-in-out forwards;
    }

    .snake-body {
      position: absolute;
      width: 150px;
      height: 60px;
      background-color: #4a9e53;
      border-radius: 30px;
      z-index: 31;
    }

    .snake-head {
      position: absolute;
      width: 80px;
      height: 80px;
      background-color: #4a9e53;
      border-radius: 40px;
      left: 130px;
      top: 10px;
      z-index: 32;
    }

    .snake-eye {
      position: absolute;
      width: 20px;
      height: 20px;
      background-color: white;
      border-radius: 50%;
      top: 20px;
      z-index: 33;
    }

    .snake-eye.left {
      right: 15px;
    }

    .snake-eye.right {
      right: 45px;
    }

    .snake-pupil {
      position: absolute;
      width: 10px;
      height: 10px;
      background-color: black;
      border-radius: 50%;
      top: 5px;
      left: 5px;
      z-index: 34;
    }

    .snake-mouth {
      position: absolute;
      width: 40px;
      height: 5px;
      background-color: #900;
      border-radius: 5px;
      bottom: 25px;
      left: 20px;
      z-index: 33;
      transform-origin: center;
      transition: all 0.3s ease;
    }

    .snake-pattern {
      position: absolute;
      width: 15px;
      height: 15px;
      background-color: #276231;
      border-radius: 50%;
      z-index: 32;
    }

    .snake-tongue {
      position: absolute;
      width: 30px;
      height: 3px;
      background-color: #f00;
      border-radius: 3px;
      bottom: 20px;
      left: 40px;
      z-index: 33;
      transform-origin: left;
      opacity: 0;
    }

    .snake-tongue::before,
    .snake-tongue::after {
      content: '';
      position: absolute;
      width: 10px;
      height: 3px;
      background-color: #f00;
      border-radius: 3px;
      top: 0;
      right: -5px;
    }

    .snake-tongue::before {
      transform: rotate(15deg);
      transform-origin: right;
    }

    .snake-tongue::after {
      transform: rotate(-15deg);
      transform-origin: right;
    }

    @keyframes snake-move {
      0% {
        left: -200px;
        transform: translateY(-50%) rotate(0deg);
      }

      20% {
        left: 10%;
        transform: translateY(-50%) rotate(-5deg);
      }

      40% {
        left: 20%;
        transform: translateY(-50%) rotate(5deg);
      }

      60% {
        left: 30%;
        transform: translateY(-50%) rotate(-5deg);
      }

      80% {
        left: 40%;
        transform: translateY(-50%) rotate(5deg);
      }

      100% {
        left: 50%;
        transform: translateY(-50%) translate(-100px, 0) rotate(0deg);
      }
    }

    @keyframes mouth-open {
      0% {
        height: 5px;
        border-radius: 5px;
        bottom: 25px;
      }

      100% {
        height: 40px;
        border-radius: 20px;
        bottom: 10px;
      }
    }

    @keyframes tongue-flick {
      0% {
        opacity: 0;
        transform: scaleX(0.8);
      }

      50% {
        opacity: 1;
        transform: scaleX(1.2);
      }

      100% {
        opacity: 0;
        transform: scaleX(0.8);
      }
    }

    @keyframes snake-jumpscare {
      0% {
        transform: scale(1) translateY(-50%) translate(-100px, 0);
      }

      50% {
        transform: scale(1.5) translateY(-50%) translate(-60px, 0);
      }

      100% {
        transform: scale(1) translateY(-50%) translate(-100px, 0);
      }
    }

    @media (max-width: 768px) {
      .dice {
        width: 30px;
        height: 30px;
      }

      .dice-dot {
        width: 4px;
        height: 4px;
      }

      .snake {
        transform: translateY(-50%) scale(0.7);
      }

      @keyframes snake-move {
        0% {
          left: -200px;
          transform: translateY(-50%) scale(0.7) rotate(0deg);
        }

        100% {
          left: 50%;
          transform: translateY(-50%) scale(0.7) translate(-100px, 0) rotate(0deg);
        }
      }

      @keyframes snake-jumpscare {
        0% {
          transform: scale(0.7) translateY(-50%) translate(-100px, 0);
        }

        50% {
          transform: scale(1.2) translateY(-50%) translate(-60px, 0);
        }

        100% {
          transform: scale(0.7) translateY(-50%) translate(-100px, 0);
        }
      }
    }

    .message-box {
      margin-top: 15px;
      text-align: center;
      font-weight: bold;
      padding: 10px;
      border-radius: 8px;
    }

    .message-box.success {
      color: #155724;
      background-color: #d4edda;
      border: 1px solid #c3e6cb;
    }

    .message-box.error {
      color: #721c24;
      background-color: #f8d7da;
      border: 1px solid #f5c6cb;
    }
  </style>
</head>

<body>
  <div class="login-page">
    <!-- Snake Animation Container -->
    <div class="snake-container">
      <div class="snake">
        <div class="snake-body"></div>
        <div class="snake-head">
          <div class="snake-eye left">
            <div class="snake-pupil"></div>
          </div>
          <div class="snake-eye right">
            <div class="snake-pupil"></div>
          </div>
          <div class="snake-mouth"></div>
          <div class="snake-tongue"></div>
        </div>
        <!-- Snake patterns -->
        <div class="snake-pattern" style="top: 15px; left: 20px;"></div>
        <div class="snake-pattern" style="top: 35px; left: 40px;"></div>
        <div class="snake-pattern" style="top: 15px; left: 60px;"></div>
        <div class="snake-pattern" style="top: 35px; left: 80px;"></div>
        <div class="snake-pattern" style="top: 15px; left: 100px;"></div>
      </div>
    </div>

    <!-- Board background -->
    <div class="board-background"></div>

    <!-- Dice container -->
    <div id="dice-container"></div>

    <!-- Login Form -->
    <div class="login-form" id="login-form-container">
      <h2 class="form-title font-fredoka">Team Login</h2>
      <form id="login-form">
        <input type="text" name="teamId" placeholder="Team ID (e.g., team-1)" required class="form-input">
        <input type="password" name="regNum" placeholder="Registration Number" required class="form-input">
        <button type="submit" class="submit-button">Let's Play!</button>
        <div id="login-message" class="message-box" style="display: none;"></div>
      </form>
    </div>
  </div>

  <script>
    // Wait for DOM content to be loaded
    document.addEventListener('DOMContentLoaded', function () {
      // Create board background cells
      const boardBackground = document.querySelector('.board-background');
      for (let i = 0; i < 96; i++) {
        const cell = document.createElement('div');
        cell.className = 'board-cell';
        cell.style.backgroundColor = `hsl(${i * 20}, 70%, 70%)`;
        boardBackground.appendChild(cell);
      }

      // Snake animation sequence
      const snake = document.querySelector('.snake');
      const snakeMouth = document.querySelector('.snake-mouth');
      const snakeTongue = document.querySelector('.snake-tongue');
      const loginForm = document.getElementById('login-form-container');
      const diceContainer = document.getElementById('dice-container');

      // Sequence the animations
      setTimeout(() => {
        snake.style.animation = 'snake-jumpscare 0.5s ease-in-out forwards';
        snakeMouth.style.animation = 'mouth-open 0.3s ease-in-out forwards';
        snakeTongue.style.animation = 'tongue-flick 0.3s ease-in-out 2';

        setTimeout(() => {
          loginForm.classList.add('form-visible');
          createDice();

          setTimeout(() => {
            snake.style.opacity = '0';
            snake.style.transition = 'opacity 1s ease';
          }, 1000);
        }, 500);
      }, 3000);

      // Handle form submission
      document.getElementById('login-form').addEventListener('submit', async function (event) {
        event.preventDefault();
        const teamId = event.target.teamId.value;
        const regNum = event.target.regNum.value;
        const loginMessage = document.getElementById('login-message');

        try {
          const response = await fetch('/login', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({ teamId, regNum }),
          });

          const data = await response.json();
          loginMessage.style.display = 'block';

          if (data.success) {
            loginMessage.textContent = 'Login successful!';
            loginMessage.classList.add('success');
            loginMessage.classList.remove('error');
            localStorage.setItem('currentTeamId', teamId);
            window.location.href = 'quiz.html';
          } else {
            loginMessage.textContent = 'Login failed: ' + data.message;
            loginMessage.classList.add('error');
            loginMessage.classList.remove('success');
          }
        } catch (error) {
          console.error('Error during login:', error);
          loginMessage.style.display = 'block';
          loginMessage.textContent = 'Network error. Please try again.';
          loginMessage.classList.add('error');
          loginMessage.classList.remove('success');
        }
      });

      // Function to create dice elements with correct dot patterns
      function createDice() {
        const diceContainer = document.getElementById('dice-container');

        // Helper function to create a single dot
        const createDot = (dice, className) => {
          const dot = document.createElement('div');
          dot.className = `dice-dot ${className}`;
          dice.appendChild(dot);
        };

        // Helper function to draw the full pattern based on the value
        const drawDots = (dice, value) => {
          switch (value) {
            case 1:
              createDot(dice, 'dot-center');
              break;
            case 2:
              createDot(dice, 'dot-top-left');
              createDot(dice, 'dot-bottom-right');
              break;
            case 3:
              createDot(dice, 'dot-top-left');
              createDot(dice, 'dot-center');
              createDot(dice, 'dot-bottom-right');
              break;
            case 4:
              createDot(dice, 'dot-top-left');
              createDot(dice, 'dot-top-right');
              createDot(dice, 'dot-bottom-left');
              createDot(dice, 'dot-bottom-right');
              break;
            case 5:
              createDot(dice, 'dot-top-left');
              createDot(dice, 'dot-top-right');
              createDot(dice, 'dot-center');
              createDot(dice, 'dot-bottom-left');
              createDot(dice, 'dot-bottom-right');
              break;
            case 6:
              createDot(dice, 'dot-top-left');
              createDot(dice, 'dot-top-right');
              createDot(dice, 'dot-middle-left');
              createDot(dice, 'dot-middle-right');
              createDot(dice, 'dot-bottom-left');
              createDot(dice, 'dot-bottom-right');
              break;
          }
        };

        for (let i = 0; i < 25; i++) {
          const dice = document.createElement('div');
          dice.className = 'dice';

          const diceValue = Math.floor(Math.random() * 6) + 1;
          const x = Math.random() * 90;
          const y = Math.random() * 90;

          dice.style.left = `${x}%`;
          dice.style.top = `${y}%`;
          dice.style.animationDuration = `${3 + Math.random() * 2}s`;
          dice.style.animationDelay = `${Math.random() * 2}s`;

          // Call the new function to draw the correct pattern
          drawDots(dice, diceValue);

          diceContainer.appendChild(dice);

          setTimeout(() => {
            dice.style.opacity = '1';
          }, 200 + i * 100);
        }
      }
    });
  </script>
</body>

</html>
